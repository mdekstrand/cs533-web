
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Building Data &#8212; CS 533 Fall 2021</title>
    
  <link href="../../../_static/css/theme.css" rel="stylesheet">
  <link href="../../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/fonts.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/togglebutton.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/tabinsert.js"></script>
    <script src="../../../_static/urlclean.js"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "mdekstrand/cs533-web");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "github-light");
    script.setAttribute("label", "üí¨ comment");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("div.section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../../../_static/logo.png"/>
    <link rel="index" title="Index" href="../../../genindex/" />
    <link rel="search" title="Search" href="../../../search/" />
    <link rel="copyright" title="Copyright" href="../../../copyright/" />
    <link rel="next" title="Finishing Touches" href="../ChartFinishingTouches/" />
    <link rel="prev" title="Tricks with Boolean Series" href="../BooleanSeries/" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../">
      
      
      
      <h1 class="site-logo" id="site-title">CS 533 Fall 2021</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search/" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../">
   CS 533 Homepage
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Course Info
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../syllabus/">
   Syllabus
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../schedule/">
   Schedule
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../glossary/">
   Glossary
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Content
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../week0/">
   Week 0 ‚Äî Pre-Class Welcome
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../week1/">
   Week 1 ‚Äî Questions (8/23‚Äì27)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../week1/DemoNotebook/">
     Demo Notebook
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../week1/1-7-types-operations/">
     Data Types and Operations
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../week2/">
   Week 2 ‚Äî Description (8/30‚Äì9/3)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../week2/2-2-PandasBasics/">
     Introducing Pandas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../week2/2-4-AggregatesAndGroups/">
     Aggregates and Groups
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../week2/2-6-DescribingDistributions/">
     Describing Distributions
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../week3/">
   Week 3 ‚Äî Presentation (9/6‚Äì10)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../week3/3-6-ChartsFromTheGroundUp/">
     Drawing Charts
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../week4/">
   Week 4 ‚Äî Inference (9/13‚Äì17)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../week5/">
   Week 5 ‚Äî Filling In (9/20‚Äì24)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../week6/">
   Week 6 ‚Äî Two Variables (Sep. 27‚ÄìOct. 1)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../week7/">
   Week 7 ‚Äî Getting Data (Oct. 4‚Äì8)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../week8/">
   Week 8 ‚Äî Regression (Oct. 11‚Äì15)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../week9/">
   Week 9 ‚Äî Models &amp; Prediction (Oct. 18‚Äì22)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../week10/">
   Week 10 ‚Äî Classification (10/25‚Äì29)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../week11/">
   Week 11 ‚Äî More Modeling (11/1‚Äì5)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../week12/">
   Week 12 ‚Äî Text (11/8‚Äì12)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../week13/">
   Week 13 ‚Äî Unsupervised (11/15‚Äì19)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../week14/">
   Week 14 ‚Äî Workflow (11/29‚Äì12/3)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../week15/">
   Week 15 ‚Äî What Next? (12/6‚Äì10)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Assignments
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../assignments/">
   Rubric
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../assignments/A0/">
   Assignment 0
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../assignments/A0/A0-Notebook/">
     CS 533 Assignment 0
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../assignments/A1/">
   Assignment 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../assignments/A2/">
   Assignment 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../assignments/A3/">
   Assignment 3
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../assignments/A4/">
   Assignment 4
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../assignments/A5/">
   Assignment 5
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../assignments/A6/">
   Assignment 6
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../assignments/A7/">
   Assignment 7
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Resources
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../software/">
   Software and Installation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../documentation/">
   Documentation &amp; Reading
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../data/">
   Data Sets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../notebook-checklist/">
   Notebook Checklist &amp; Guide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../probability/">
   Notes on Probability
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../problems/">
   Common Problems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../onyx/">
   Remotely Using Onyx
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../git-resources/">
   Git Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../environments/">
   Software Environments
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../">
   Tutorials
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="../AdvancedPipeline/">
     Advanced Pipeline Example
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../BooleanSeries/">
     Tricks with Boolean Series
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Building Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ChartFinishingTouches/">
     Finishing Touches
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Charting/">
     Drawing Charts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ClusteringExample/">
     Clustering Example
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Correlation/">
     Correlation and Basic Linear Model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../CriticScores/">
     Charting Movie Scores
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Distributions/">
     Distributions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../EmpiricalProbabilities/">
     Empirical Probabilities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../FetchCHIPapers/">
     Bibliography Fetch
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../FunWithNumbers/">
     Fun with Numbers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Functions/">
     Writing Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Indexing/">
     Indexing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../LogitRegressionDemo/">
     Logistic Regression Demo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../MLTimeSeries/">
     MovieLens Time Series
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../MinimizeRegression/">
     Rebuilding Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../MissingData/">
     Missing Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../MovieDecomp/">
     Movie Matrix Decomposition
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../OneSample/">
     One Sample
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../OverfittingSimulation/">
     Overfitting Simulation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../PCADemo/">
     PCA Demo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../PenguinSamples/">
     Sampling and Testing the Penguins
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Regressions/">
     Regressions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Reshaping/">
     Reshaping Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../SamplingDists/">
     Sampling Distributions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../SciKitLogistic/">
     SciKit Logistic Regression Demo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../SciKitPipeline/">
     SciKit Pipeline and Transform Demo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../SciKitRegression/">
     SciKit-Learn Linear Regression Demo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../SciKitTransform/">
     SciKit Transformations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Selection/">
     Selecting Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Sessions/">
     Sessionization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../SpamFilter/">
     Spam Detector Example
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../TuningExample/">
     Tuning Example
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../UsingTheCensus/">
     Using Census Data
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Site Details
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../copyright/">
   Copyright and License
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../../_sources/resources/tutorials/BuildingData.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/mdekstrand/cs533-web"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/mdekstrand/cs533-web/issues/new?title=Issue%20on%20page%20%2Fresources/tutorials/BuildingData.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/mdekstrand/cs533-web/edit/main/resources/tutorials/BuildingData.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setup-and-data-load">
   Setup and Data Load
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#creating-arrays">
   Creating Arrays
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#creating-series">
   Creating Series
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#from-an-array-like">
     From an Array-Like
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#from-a-single-value">
     From a Single Value
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#building-up">
     Building Up
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-ordinal">
     Example: Ordinal
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#creating-data-frames">
   Creating Data Frames
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#from-one-series">
     From One Series
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#from-multiple-series">
     From Multiple Series
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#from-a-list-of-rows">
     From a List of Rows
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="building-data">
<h1>Building Data<a class="headerlink" href="#building-data" title="Permalink to this headline">¬∂</a></h1>
<p>This notebook discusses how to <em>build</em> a series or data frame, possibly using pieces of other series or data frames, to either make new columns for our data or set up a new data frame.</p>
<p>We are going to use the <a class="reference external" href="https://grouplens.org/datasets/hetrec-2011/">HETREC MovieLens data</a> again.</p>
<div class="section" id="setup-and-data-load">
<h2>Setup and Data Load<a class="headerlink" href="#setup-and-data-load" title="Permalink to this headline">¬∂</a></h2>
<p>Load our Python modules:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</pre></div>
</div>
</div>
</div>
<p>Load the movie data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movies</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="s1">&#39;hetrec2011-ml/movies.dat&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin1&#39;</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">N&#39;</span><span class="p">])</span>
<span class="n">movies</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>title</th>
      <th>imdbID</th>
      <th>spanishTitle</th>
      <th>imdbPictureURL</th>
      <th>year</th>
      <th>rtID</th>
      <th>rtAllCriticsRating</th>
      <th>rtAllCriticsNumReviews</th>
      <th>rtAllCriticsNumFresh</th>
      <th>...</th>
      <th>rtAllCriticsScore</th>
      <th>rtTopCriticsRating</th>
      <th>rtTopCriticsNumReviews</th>
      <th>rtTopCriticsNumFresh</th>
      <th>rtTopCriticsNumRotten</th>
      <th>rtTopCriticsScore</th>
      <th>rtAudienceRating</th>
      <th>rtAudienceNumRatings</th>
      <th>rtAudienceScore</th>
      <th>rtPictureURL</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Toy story</td>
      <td>114709</td>
      <td>Toy story (juguetes)</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTMwNDU0...</td>
      <td>1995</td>
      <td>toy_story</td>
      <td>9.0</td>
      <td>73.0</td>
      <td>73.0</td>
      <td>...</td>
      <td>100.0</td>
      <td>8.5</td>
      <td>17.0</td>
      <td>17.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>3.7</td>
      <td>102338.0</td>
      <td>81.0</td>
      <td>http://content7.flixster.com/movie/10/93/63/10...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Jumanji</td>
      <td>113497</td>
      <td>Jumanji</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMzM5NjE1...</td>
      <td>1995</td>
      <td>1068044-jumanji</td>
      <td>5.6</td>
      <td>28.0</td>
      <td>13.0</td>
      <td>...</td>
      <td>46.0</td>
      <td>5.8</td>
      <td>5.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>40.0</td>
      <td>3.2</td>
      <td>44587.0</td>
      <td>61.0</td>
      <td>http://content8.flixster.com/movie/56/79/73/56...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Grumpy Old Men</td>
      <td>107050</td>
      <td>Dos viejos gru√±ones</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTI5MTgy...</td>
      <td>1993</td>
      <td>grumpy_old_men</td>
      <td>5.9</td>
      <td>36.0</td>
      <td>24.0</td>
      <td>...</td>
      <td>66.0</td>
      <td>7.0</td>
      <td>6.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>83.0</td>
      <td>3.2</td>
      <td>10489.0</td>
      <td>66.0</td>
      <td>http://content6.flixster.com/movie/25/60/25602...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Waiting to Exhale</td>
      <td>114885</td>
      <td>Esperando un respiro</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTczMTMy...</td>
      <td>1995</td>
      <td>waiting_to_exhale</td>
      <td>5.6</td>
      <td>25.0</td>
      <td>14.0</td>
      <td>...</td>
      <td>56.0</td>
      <td>5.5</td>
      <td>11.0</td>
      <td>5.0</td>
      <td>6.0</td>
      <td>45.0</td>
      <td>3.3</td>
      <td>5666.0</td>
      <td>79.0</td>
      <td>http://content9.flixster.com/movie/10/94/17/10...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Father of the Bride Part II</td>
      <td>113041</td>
      <td>Vuelve el padre de la novia (Ahora tambi√©n abu...</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTg1NDc2...</td>
      <td>1995</td>
      <td>father_of_the_bride_part_ii</td>
      <td>5.3</td>
      <td>19.0</td>
      <td>9.0</td>
      <td>...</td>
      <td>47.0</td>
      <td>5.4</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>20.0</td>
      <td>3.0</td>
      <td>13761.0</td>
      <td>64.0</td>
      <td>http://content8.flixster.com/movie/25/54/25542...</td>
    </tr>
  </tbody>
</table>
<p>5 rows √ó 21 columns</p>
</div></div></div>
</div>
<p>And the ratings:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ratings</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="s1">&#39;hetrec2011-ml/user_ratedmovies-timestamps.dat&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">ratings</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>userID</th>
      <th>movieID</th>
      <th>rating</th>
      <th>timestamp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>75</td>
      <td>3</td>
      <td>1.0</td>
      <td>1162160236000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>75</td>
      <td>32</td>
      <td>4.5</td>
      <td>1162160624000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>75</td>
      <td>110</td>
      <td>4.0</td>
      <td>1162161008000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>75</td>
      <td>160</td>
      <td>2.0</td>
      <td>1162160212000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>75</td>
      <td>163</td>
      <td>4.0</td>
      <td>1162160970000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We‚Äôre also going to use genres:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movie_genres</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="s1">&#39;hetrec2011-ml/movie_genres.dat&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">movie_genres</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movieID</th>
      <th>genre</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Adventure</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Animation</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>Children</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>Comedy</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>Fantasy</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movie_genres</span><span class="p">[</span><span class="s1">&#39;genre&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Drama          5076
Comedy         3566
Thriller       1664
Romance        1644
Action         1445
Crime          1086
Adventure      1003
Horror          978
Sci-Fi          740
Fantasy         535
Children        519
Mystery         497
War             494
Documentary     430
Musical         421
Animation       279
Western         261
Film-Noir       145
IMAX             25
Short             1
Name: genre, dtype: int64
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="creating-arrays">
<h2>Creating Arrays<a class="headerlink" href="#creating-arrays" title="Permalink to this headline">¬∂</a></h2>
<p>Let‚Äôs start with how to build a NumPy array, before we even get to series and frames.</p>
<p>NumPy gives us several ways to create arrays.  We can use <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.array.html"><code class="docutils literal notranslate"><span class="pre">np.array</span></code></a> to create one from a list, array, data series, or anything else that NumPy thinks looks like an array (the NumPy and Pandas documentation call such objects ‚Äúarray-like‚Äù).</p>
<p>So let‚Äôs make an array:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 0,  2,  5,  9, -3])
</pre></div>
</div>
</div>
</div>
<p>We can also create an array from a range, with <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html"><code class="docutils literal notranslate"><span class="pre">np.arange</span></code></a>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
</pre></div>
</div>
</div>
</div>
<p>Another super useful way to make an array is <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.linspace.html"><code class="docutils literal notranslate"><span class="pre">np.linspace</span></code></a>, which creates an array consisting of evenly-spaced points between two other values, including both of the endpoints:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.        , 0.55555556, 1.11111111, 1.66666667, 2.22222222,
       2.77777778, 3.33333333, 3.88888889, 4.44444444, 5.        ])
</pre></div>
</div>
</div>
</div>
<p>Because it‚Äôs creating 10 points <strong>including</strong> 0 and 5, it doesn‚Äôt include many integer values.  Creating 11 points would fix that:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0. , 0.5, 1. , 1.5, 2. , 2.5, 3. , 3.5, 4. , 4.5, 5. ])
</pre></div>
</div>
</div>
</div>
<p>We can also randomly generate arrays.  There are a lot of RNG features in NumPy (see <a class="reference external" href="https://numpy.org/doc/stable/reference/random/index.html">the documentation</a>); we‚Äôll start with generating 100 ‚Äústandard normal‚Äù values (normally distributed with mean 0 and variance 1):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-0.33873561,  0.51678273,  0.14711789,  0.19838675,  0.54761942,
        0.19131156, -0.4752898 ,  0.02024525, -1.33948309,  0.32448087,
       -0.19374478,  0.8344856 , -1.2166371 , -0.37482094,  0.86518527,
        2.18446418,  0.6075668 , -2.31585428, -0.74720259,  1.19992932,
        0.99405759,  2.23903908,  1.81167178,  1.00598331,  0.55223142,
        0.67745515,  0.58957695, -0.46088752,  0.33887571, -0.27662875,
       -1.32340716,  0.13839638, -0.57016739, -0.58275332,  1.09105615,
       -0.61806743,  2.12021099,  1.24762095, -0.91650255, -0.50467559,
       -1.01163067,  0.28069416, -0.35173081, -0.89731573,  1.08407209,
       -1.69627407,  0.07576669, -0.08138856,  1.46850213,  0.36764678,
        0.0687904 ,  1.61086781, -0.90819236, -0.60426599,  0.81166916,
        0.29945399, -0.56891978, -1.67152667, -0.69264555, -0.45211381,
        0.30505253,  0.11921514, -1.26780228, -0.017003  ,  0.91574513,
       -0.26769486, -0.72651488,  0.04675951, -0.53645195, -0.03073815,
       -0.71287014, -0.40548066, -1.16452118,  1.23470357,  1.14105292,
        0.20514277, -1.58428461,  1.1993169 , -0.18210597,  0.00771399,
        0.45130548,  0.98739545,  1.71867103, -1.28923256,  0.70000841,
       -2.64988258,  1.91856809,  2.27360025, -0.50856635, -0.84726367,
        0.50152163, -0.4735734 ,  0.49285562, -0.970693  ,  0.27513337,
        0.26262928,  0.73655456,  1.09339154, -0.88900962,  1.62158089])
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="creating-series">
<h2>Creating Series<a class="headerlink" href="#creating-series" title="Permalink to this headline">¬∂</a></h2>
<p>Now let‚Äôs look at creating pandas <code class="docutils literal notranslate"><span class="pre">Series</span></code> objects.</p>
<div class="section" id="from-an-array-like">
<h3>From an Array-Like<a class="headerlink" href="#from-an-array-like" title="Permalink to this headline">¬∂</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">Series</span></code> constructor takes an array-like:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    0
1    1
2    2
3    3
4    4
dtype: int32
</pre></div>
</div>
</div>
</div>
<p>This series has no name, no index name, and it has the integer values 0 through 4.  Since it has no specified index, it uses a <code class="docutils literal notranslate"><span class="pre">RangeIndex</span></code>, which indexes, again from 0 to 4.</p>
<p>We can specify an index as an array-like:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">abc</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">14</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;apple&#39;</span><span class="p">,</span> <span class="s1">&#39;banana&#39;</span><span class="p">,</span> <span class="s1">&#39;carrot&#39;</span><span class="p">])</span>
<span class="n">abc</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>apple      1
banana     3
carrot    14
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Now we have the values 1, 3, and 14 in a series, associated with index keys ‚Äòapple‚Äô, ‚Äòbanana‚Äô, and ‚Äòcarrot‚Äô respectively.  We can look up values like we‚Äôve seen:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">abc</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;banana&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="from-a-single-value">
<h3>From a Single Value<a class="headerlink" href="#from-a-single-value" title="Permalink to this headline">¬∂</a></h3>
<p>The constructor can also take a single value, and create a series with that value for every element.  For this use case, we must provide an index.</p>
<p>For example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a    0
b    0
c    0
d    0
dtype: int64
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="building-up">
<h3>Building Up<a class="headerlink" href="#building-up" title="Permalink to this headline">¬∂</a></h3>
<p>With this, we can then assign other values at particular places:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>
<span class="n">s</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a    0
b    0
c    0
d    0
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">s</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a    0
b    7
c    0
d    0
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>We can do this with boolean masks, too ‚Äî suppose we want to create a series that indicates if its index keys are odd or even:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="s1">&#39;odd&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">s</span><span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;even&#39;</span>
<span class="n">s</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    even
1     odd
2    even
3     odd
4    even
5     odd
6    even
7     odd
8    even
9     odd
dtype: object
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="example-ordinal">
<h3>Example: Ordinal<a class="headerlink" href="#example-ordinal" title="Permalink to this headline">¬∂</a></h3>
<p>Our <code class="docutils literal notranslate"><span class="pre">movies</span></code> frame has a <code class="docutils literal notranslate"><span class="pre">year</span></code> column, indicating the year.</p>
<p>Certain sci-fi movies were era-defining: they had an unmistakable influence on the movies after them.  Let‚Äôs, for sake of an argument, define the eras as follows:</p>
<ol class="simple">
<li><p>Vintage (movies through 1977, when <em>Star Wars</em> came out)</p></li>
<li><p>Star Wars (1978‚Äì1999)</p></li>
<li><p>Post-Matrix (after 1999)</p></li>
</ol>
<p>We can do that with the following steps:</p>
<ol class="simple">
<li><p>Create a <code class="docutils literal notranslate"><span class="pre">Series</span></code> with the index matching the movie frame, and one of the values.</p></li>
<li><p>Use masks based on conditions selecting the other items to fill in the othe values</p></li>
<li><p>(if wanted) Set up the categorical data type with a specified order.</p></li>
</ol>
<p>Let‚Äôs start by finding the sci-fi movies - all movies with <code class="docutils literal notranslate"><span class="pre">Sci-Fi</span></code> as one of their genres:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scifi_ids</span> <span class="o">=</span> <span class="n">movie_genres</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">movie_genres</span><span class="p">[</span><span class="s1">&#39;genre&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Sci-Fi&#39;</span><span class="p">,</span> <span class="s1">&#39;movieID&#39;</span><span class="p">]</span>
<span class="n">scifi</span> <span class="o">=</span> <span class="n">movies</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">scifi_ids</span><span class="p">]</span>
<span class="n">scifi</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>imdbID</th>
      <th>spanishTitle</th>
      <th>imdbPictureURL</th>
      <th>year</th>
      <th>rtID</th>
      <th>rtAllCriticsRating</th>
      <th>rtAllCriticsNumReviews</th>
      <th>rtAllCriticsNumFresh</th>
      <th>rtAllCriticsNumRotten</th>
      <th>rtAllCriticsScore</th>
      <th>rtTopCriticsRating</th>
      <th>rtTopCriticsNumReviews</th>
      <th>rtTopCriticsNumFresh</th>
      <th>rtTopCriticsNumRotten</th>
      <th>rtTopCriticsScore</th>
      <th>rtAudienceRating</th>
      <th>rtAudienceNumRatings</th>
      <th>rtAudienceScore</th>
      <th>rtPictureURL</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>24</th>
      <td>Powder</td>
      <td>114168</td>
      <td>Powder - pura energ√≠a</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTIwMTQ3...</td>
      <td>1995</td>
      <td>powder</td>
      <td>5.2</td>
      <td>19.0</td>
      <td>9.0</td>
      <td>10.0</td>
      <td>47.0</td>
      <td>4.9</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>3.1</td>
      <td>6650.0</td>
      <td>67.0</td>
      <td>http://content7.flixster.com/movie/25/59/25590...</td>
    </tr>
    <tr>
      <th>29</th>
      <td>La cit√© des enfants perdus</td>
      <td>112682</td>
      <td>La ciudad de los ni√±os perdidos</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTI4MDc0...</td>
      <td>1995</td>
      <td>city_of_lost_children</td>
      <td>7.0</td>
      <td>33.0</td>
      <td>27.0</td>
      <td>6.0</td>
      <td>81.0</td>
      <td>7.2</td>
      <td>7.0</td>
      <td>5.0</td>
      <td>2.0</td>
      <td>71.0</td>
      <td>4.0</td>
      <td>22420.0</td>
      <td>89.0</td>
      <td>http://content6.flixster.com/movie/26/78/26782...</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Twelve Monkeys</td>
      <td>114746</td>
      <td>Twelve monkeys: doce monos</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTQwNzg2...</td>
      <td>1995</td>
      <td>prem-no-public-issue</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>http://content6.flixster.com/movie/10/93/02/10...</td>
    </tr>
    <tr>
      <th>66</th>
      <td>Lawnmower Man 2: Beyond Cyberspace</td>
      <td>116839</td>
      <td>El cortador de c√©sped II: m√°s all√° del ciberes...</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTg1MjM3...</td>
      <td>1996</td>
      <td>lawnmower_man_2_jobes_war</td>
      <td>2.8</td>
      <td>9.0</td>
      <td>1.0</td>
      <td>8.0</td>
      <td>11.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>33.0</td>
      <td>2.1</td>
      <td>952.0</td>
      <td>18.0</td>
      <td>http://content7.flixster.com/movie/10/86/80/10...</td>
    </tr>
    <tr>
      <th>76</th>
      <td>Screamers</td>
      <td>114367</td>
      <td>Asesinos cibern√©ticos</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTY5NTQz...</td>
      <td>1995</td>
      <td>1069696-screamers</td>
      <td>4.7</td>
      <td>30.0</td>
      <td>9.0</td>
      <td>21.0</td>
      <td>30.0</td>
      <td>4.9</td>
      <td>9.0</td>
      <td>2.0</td>
      <td>7.0</td>
      <td>22.0</td>
      <td>3.0</td>
      <td>2070.0</td>
      <td>45.0</td>
      <td>http://content7.flixster.com/movie/27/23/27230...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>63617</th>
      <td>Christmas on Mars</td>
      <td>363240</td>
      <td>Christmas on Mars</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTYzNjQ3...</td>
      <td>2008</td>
      <td>christmas_on_mars</td>
      <td>5.5</td>
      <td>6.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>50.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>50.0</td>
      <td>3.3</td>
      <td>530.0</td>
      <td>56.0</td>
      <td>http://content6.flixster.com/movie/10/88/98/10...</td>
    </tr>
    <tr>
      <th>63676</th>
      <td>Tanin no kao</td>
      <td>61065</td>
      <td>Tanin no kao</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTk3OTkz...</td>
      <td>1966</td>
      <td>face_of_another</td>
      <td>7.4</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>4.1</td>
      <td>598.0</td>
      <td>90.0</td>
      <td>http://content8.flixster.com/movie/93/50/55/93...</td>
    </tr>
    <tr>
      <th>63989</th>
      <td>The Devil-Doll</td>
      <td>27521</td>
      <td>Mu√±ecos infernales</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTU5MTk0...</td>
      <td>1936</td>
      <td>the-devildoll-the-witch-of-timbuctoo</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>http://content6.flixster.com/movie/10/87/02/10...</td>
    </tr>
    <tr>
      <th>64497</th>
      <td>The Day the Earth Stood Still</td>
      <td>43456</td>
      <td>Ultim√°tum a la Tierra</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTQ2MzYy...</td>
      <td>1951</td>
      <td>1005371-day_the_earth_stood_still</td>
      <td>8.0</td>
      <td>50.0</td>
      <td>47.0</td>
      <td>3.0</td>
      <td>94.0</td>
      <td>7.0</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>80.0</td>
      <td>3.8</td>
      <td>8999.0</td>
      <td>86.0</td>
      <td>http://content7.flixster.com/movie/10/87/31/10...</td>
    </tr>
    <tr>
      <th>64508</th>
      <td>Starship Troopers 3: Marauder</td>
      <td>844760</td>
      <td>Starship Troopers 3: Marauder</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTQyMTcw...</td>
      <td>2008</td>
      <td>starship_troopers_3</td>
      <td>5.4</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>60.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>http://content9.flixster.com/movie/10/85/24/10...</td>
    </tr>
  </tbody>
</table>
<p>740 rows √ó 20 columns</p>
</div></div></div>
</div>
<p>And start making eras:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">era</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="s1">&#39;Vintage&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">scifi</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">era</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>id
24       Vintage
29       Vintage
32       Vintage
66       Vintage
76       Vintage
          ...   
63617    Vintage
63676    Vintage
63989    Vintage
64497    Vintage
64508    Vintage
Length: 740, dtype: object
</pre></div>
</div>
</div>
</div>
<p>Set Star Wars for after 1977 (we won‚Äôt bother with the end condition, because we‚Äôll override those values in the next step):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">era</span><span class="p">[</span><span class="n">scifi</span><span class="o">.</span><span class="n">year</span> <span class="o">&gt;</span> <span class="mi">1977</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Star Wars&#39;</span>
<span class="n">era</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>id
24       Star Wars
29       Star Wars
32       Star Wars
66       Star Wars
76       Star Wars
           ...    
63617    Star Wars
63676      Vintage
63989      Vintage
64497      Vintage
64508    Star Wars
Length: 740, dtype: object
</pre></div>
</div>
</div>
</div>
<p>And then set ‚ÄòPost-Matrix‚Äô for after 1999:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">era</span><span class="p">[</span><span class="n">scifi</span><span class="o">.</span><span class="n">year</span> <span class="o">&gt;</span> <span class="mi">1999</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Post-Matrix&#39;</span>
<span class="n">era</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>id
24         Star Wars
29         Star Wars
32         Star Wars
66         Star Wars
76         Star Wars
            ...     
63617    Post-Matrix
63676        Vintage
63989        Vintage
64497        Vintage
64508    Post-Matrix
Length: 740, dtype: object
</pre></div>
</div>
</div>
</div>
<p>Now we can add this as a column in our data frame:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scifi</span><span class="p">[</span><span class="s1">&#39;era&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">era</span>
</pre></div>
</div>
</div>
</div>
<p>How many sci-fi movies do we have from each era?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">scifi</span><span class="p">[</span><span class="s1">&#39;era&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1fdb6bc0880&gt;
</pre></div>
</div>
<img alt="../../../_images/BuildingData_45_1.png" src="../../../_images/BuildingData_45_1.png" />
</div>
</div>
<p>But this era is in the wrong order!  That‚Äôs no good.  We can fix that by making the <code class="docutils literal notranslate"><span class="pre">era</span></code> an <em>ordered categorical</em>.  We often leave categorical variables as strings, unless we have a very large number of data points, but we don‚Äôt get control over their order.</p>
<p>Let‚Äôs make it a categorical variable:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">era</span> <span class="o">=</span> <span class="n">era</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>And set the category order:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">era</span> <span class="o">=</span> <span class="n">era</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">reorder_categories</span><span class="p">([</span><span class="s1">&#39;Vintage&#39;</span><span class="p">,</span> <span class="s1">&#39;Star Wars&#39;</span><span class="p">,</span> <span class="s1">&#39;Post-Matrix&#39;</span><span class="p">])</span>
<span class="n">scifi</span><span class="p">[</span><span class="s1">&#39;era&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">era</span>
<span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">scifi</span><span class="p">[</span><span class="s1">&#39;era&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1fdb744d850&gt;
</pre></div>
</div>
<img alt="../../../_images/BuildingData_49_1.png" src="../../../_images/BuildingData_49_1.png" />
</div>
</div>
</div>
</div>
<div class="section" id="creating-data-frames">
<h2>Creating Data Frames<a class="headerlink" href="#creating-data-frames" title="Permalink to this headline">¬∂</a></h2>
<p>In this section, we‚Äôre going to see how to create data frames!</p>
<div class="section" id="from-one-series">
<h3>From One Series<a class="headerlink" href="#from-one-series" title="Permalink to this headline">¬∂</a></h3>
<p>We can create a data frame from <em>one</em> series by using the <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.to_frame.html"><code class="docutils literal notranslate"><span class="pre">to_frame</span></code></a> method, as seen in <a class="reference internal" href="../Reshaping/"><span class="doc std std-doc">Reshaping</span></a>.</p>
<p>Let‚Äôs get a series:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">id_s</span> <span class="o">=</span> <span class="n">movies</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
<span class="n">id_s</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0            1
1            2
2            3
3            4
4            5
         ...  
10192    65088
10193    65091
10194    65126
10195    65130
10196    65133
Name: id, Length: 10197, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>And convert it to a frame:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mids</span> <span class="o">=</span> <span class="n">id_s</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="s1">&#39;movieID&#39;</span><span class="p">)</span>
<span class="n">mids</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movieID</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>10192</th>
      <td>65088</td>
    </tr>
    <tr>
      <th>10193</th>
      <td>65091</td>
    </tr>
    <tr>
      <th>10194</th>
      <td>65126</td>
    </tr>
    <tr>
      <th>10195</th>
      <td>65130</td>
    </tr>
    <tr>
      <th>10196</th>
      <td>65133</td>
    </tr>
  </tbody>
</table>
<p>10197 rows √ó 1 columns</p>
</div></div></div>
</div>
<p>This <strong>preserves the index</strong>.</p>
</div>
<div class="section" id="from-multiple-series">
<h3>From Multiple Series<a class="headerlink" href="#from-multiple-series" title="Permalink to this headline">¬∂</a></h3>
<p>If we have multiple series, with the same or compatible indexes, we can create a data frame from a <em>dictionary</em> mapping column names to series:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titles</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;movieID&#39;</span><span class="p">:</span> <span class="n">movies</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span>
    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="n">movies</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>
<span class="p">})</span>
<span class="n">titles</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movieID</th>
      <th>title</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Toy story</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Jumanji</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Grumpy Old Men</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Waiting to Exhale</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Father of the Bride Part II</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>10192</th>
      <td>65088</td>
      <td>Bedtime Stories</td>
    </tr>
    <tr>
      <th>10193</th>
      <td>65091</td>
      <td>Manhattan Melodrama</td>
    </tr>
    <tr>
      <th>10194</th>
      <td>65126</td>
      <td>Choke</td>
    </tr>
    <tr>
      <th>10195</th>
      <td>65130</td>
      <td>Revolutionary Road</td>
    </tr>
    <tr>
      <th>10196</th>
      <td>65133</td>
      <td>Blackadder Back &amp; Forth</td>
    </tr>
  </tbody>
</table>
<p>10197 rows √ó 2 columns</p>
</div></div></div>
</div>
<p>We can also use NumPy arrays or Python lists instead of Pandas series, so long as they are all the same length.</p>
<p>We can also provide an index (with <code class="docutils literal notranslate"><span class="pre">index=</span></code>) in the data frame constructor.</p>
</div>
<div class="section" id="from-a-list-of-rows">
<h3>From a List of Rows<a class="headerlink" href="#from-a-list-of-rows" title="Permalink to this headline">¬∂</a></h3>
<p>One more way to create a data frame is from a list (or any iterable) of rows, where each row is either a tuple or a dictionary.
The <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.from_records.html"><code class="docutils literal notranslate"><span class="pre">from_records</span></code></a> function does this.</p>
<p>If the rows are dictionaries, their keys are used as column names; if they are tuples, you can specify a column name with <code class="docutils literal notranslate"><span class="pre">columns=['name1',</span> <span class="pre">'name2']</span></code>.</p>
<p>One very common source of data like this is when we are reading data that comes to us in a list or file of JSON objects, or some other source of dictionaries (such as the census data, or a MongoDB connection).</p>
<p>For example, the <a class="reference external" href="https://cseweb.ucsd.edu/~jmcauley/datasets.html#clothing_fit">Rent the Runway data</a> comes as a GZIP-compressed list of JSON objects, one per line.  We can read this into a list of JSON objects like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span><span class="o">,</span> <span class="nn">gzip</span>
<span class="k">with</span> <span class="n">gzip</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;renttherunway_final_data.json.gz&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">zf</span><span class="p">:</span>
    <span class="n">rtr_records</span> <span class="o">=</span> <span class="p">[</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">zf</span><span class="p">]</span>

<span class="c1"># dump first value of list</span>
<span class="n">rtr_records</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;fit&#39;: &#39;fit&#39;,
 &#39;user_id&#39;: &#39;420272&#39;,
 &#39;bust size&#39;: &#39;34d&#39;,
 &#39;item_id&#39;: &#39;2260466&#39;,
 &#39;weight&#39;: &#39;137lbs&#39;,
 &#39;rating&#39;: &#39;10&#39;,
 &#39;rented for&#39;: &#39;vacation&#39;,
 &#39;review_text&#39;: &quot;An adorable romper! Belt and zipper were a little hard to navigate in a full day of wear/bathroom use, but that&#39;s to be expected. Wish it had pockets, but other than that-- absolutely perfect! I got a million compliments.&quot;,
 &#39;body type&#39;: &#39;hourglass&#39;,
 &#39;review_summary&#39;: &#39;So many compliments!&#39;,
 &#39;category&#39;: &#39;romper&#39;,
 &#39;height&#39;: &#39;5\&#39; 8&quot;&#39;,
 &#39;size&#39;: 14,
 &#39;age&#39;: &#39;28&#39;,
 &#39;review_date&#39;: &#39;April 20, 2016&#39;}
</pre></div>
</div>
</div>
</div>
<p>We can then use <code class="docutils literal notranslate"><span class="pre">from_records</span></code> to make a data frame:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rtr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">rtr_records</span><span class="p">)</span>
<span class="n">rtr</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 192544 entries, 0 to 192543
Data columns (total 15 columns):
 #   Column          Non-Null Count   Dtype 
---  ------          --------------   ----- 
 0   fit             192544 non-null  object
 1   user_id         192544 non-null  object
 2   bust size       174133 non-null  object
 3   item_id         192544 non-null  object
 4   weight          162562 non-null  object
 5   rating          192462 non-null  object
 6   rented for      192534 non-null  object
 7   review_text     192544 non-null  object
 8   body type       177907 non-null  object
 9   review_summary  192544 non-null  object
 10  category        192544 non-null  object
 11  height          191867 non-null  object
 12  size            192544 non-null  int64 
 13  age             191584 non-null  object
 14  review_date     192544 non-null  object
dtypes: int64(1), object(14)
memory usage: 22.0+ MB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rtr</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fit</th>
      <th>user_id</th>
      <th>bust size</th>
      <th>item_id</th>
      <th>weight</th>
      <th>rating</th>
      <th>rented for</th>
      <th>review_text</th>
      <th>body type</th>
      <th>review_summary</th>
      <th>category</th>
      <th>height</th>
      <th>size</th>
      <th>age</th>
      <th>review_date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>fit</td>
      <td>420272</td>
      <td>34d</td>
      <td>2260466</td>
      <td>137lbs</td>
      <td>10</td>
      <td>vacation</td>
      <td>An adorable romper! Belt and zipper were a lit...</td>
      <td>hourglass</td>
      <td>So many compliments!</td>
      <td>romper</td>
      <td>5' 8"</td>
      <td>14</td>
      <td>28</td>
      <td>April 20, 2016</td>
    </tr>
    <tr>
      <th>1</th>
      <td>fit</td>
      <td>273551</td>
      <td>34b</td>
      <td>153475</td>
      <td>132lbs</td>
      <td>10</td>
      <td>other</td>
      <td>I rented this dress for a photo shoot. The the...</td>
      <td>straight &amp; narrow</td>
      <td>I felt so glamourous!!!</td>
      <td>gown</td>
      <td>5' 6"</td>
      <td>12</td>
      <td>36</td>
      <td>June 18, 2013</td>
    </tr>
    <tr>
      <th>2</th>
      <td>fit</td>
      <td>360448</td>
      <td>NaN</td>
      <td>1063761</td>
      <td>NaN</td>
      <td>10</td>
      <td>party</td>
      <td>This hugged in all the right places! It was a ...</td>
      <td>NaN</td>
      <td>It was a great time to celebrate the (almost) ...</td>
      <td>sheath</td>
      <td>5' 4"</td>
      <td>4</td>
      <td>116</td>
      <td>December 14, 2015</td>
    </tr>
    <tr>
      <th>3</th>
      <td>fit</td>
      <td>909926</td>
      <td>34c</td>
      <td>126335</td>
      <td>135lbs</td>
      <td>8</td>
      <td>formal affair</td>
      <td>I rented this for my company's black tie award...</td>
      <td>pear</td>
      <td>Dress arrived on time and in perfect condition.</td>
      <td>dress</td>
      <td>5' 5"</td>
      <td>8</td>
      <td>34</td>
      <td>February 12, 2014</td>
    </tr>
    <tr>
      <th>4</th>
      <td>fit</td>
      <td>151944</td>
      <td>34b</td>
      <td>616682</td>
      <td>145lbs</td>
      <td>10</td>
      <td>wedding</td>
      <td>I have always been petite in my upper body and...</td>
      <td>athletic</td>
      <td>Was in love with this dress !!!</td>
      <td>gown</td>
      <td>5' 9"</td>
      <td>12</td>
      <td>27</td>
      <td>September 26, 2016</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We would then need to go convert a lot of data types, but we have the data!</p>
<blockquote>
<div><p><strong>Note:</strong> Pandas also provides functions to read JSON lines from a file.  But <code class="docutils literal notranslate"><span class="pre">from_records</span></code> has a lot of uses.</p>
</div></blockquote>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./resources\tutorials"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="../BooleanSeries/" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Tricks with Boolean Series</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../ChartFinishingTouches/" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Finishing Touches</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Michael D. Ekstrand<br/>
        
            &copy; <a href="../../../copyright/">Copyright</a> 2021.<br/>
          <div class="extra_footer">
            <script data-goatcounter="https://cs533.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>

          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>